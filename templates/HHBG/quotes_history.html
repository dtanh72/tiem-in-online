{% extends 'UI/base.html' %}

{% block title %}QUẢN LÝ BÁO GIÁ{% endblock %}

{% block content %}

    <h1>Lịch sử Báo giá</h1>

    <form class="filter-form" method="GET" action="{{ url_for('quotes_history_page') }}" class="card card-body bg-light mb-4">
        <div class="row">
			<div class="col-6"><label for="start_date" class="form-label">Từ ngày:</label></div>
			<div class="col-6"><label for="end_date" class="form-label">Đến ngày:</label></div>
		</div>
		<div class="row">
			<div class="col-6"><input type="date" id="start_date" name="start_date" value="{{ start_date or '' }}" class="form-control"></div>
			<div class="col-6"><input type="date" id="end_date" name="end_date" value="{{ end_date or '' }}" class="form-control"></div>
		</div>
		</br>	
		<div class="row">
			<div class="col-md-8">
				<button type="submit" class="btn btn-primary w-100">Lọc</button>
			</div>
			<div class="col-md-4">
				<a href="{{ url_for('quotes_history_page', filter='all') }}" class="btn btn-danger w-100">Xóa lọc</a>
			</div>
		</div>
    </form>
    
	<div class="container mt-3">
		<h2 class="mb-3">
			Tổng giá trị (theo bộ lọc): {{ total_quotes_value|currency }} vnđ
		</h2>
	</div>

    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>Mã BG</th>
                <th>Ngày tạo</th>
                <th>Tên Khách hàng</th>
                <th>Tổng tiền (vnđ)</th>
                <th>Trạng thái</th>
                <th>Chi tiết</th>
            </tr>
        </thead>
        <tbody>
			{% for quote in quotes_list %}
			<tr>
				<td>{{ quote.quote_id }}</td>
				<td>{{ quote.created_date }}</td>
				<td>{{ quote.customer_name }}</td>
				<td>{{ quote.total_amount|currency }}</td>
				<td class="status-{{ quote.status }}">{{ quote.status }}</td>
				<td>
					<a href="{{ url_for('quote_detail_page', quote_id=quote.quote_id) }}" class="btn btn-sm btn-warning">Xem</a>
					
					{% if quote.status == 'pending' %}
						<a href="{{ url_for('edit_quote_page', quote_id=quote.quote_id) }}" class="btn btn-sm btn-warning">Sửa</a>
					{% endif %}
				</td>
			</tr>
			{% endfor %}
		</tbody>
    </table>

{% endblock %}